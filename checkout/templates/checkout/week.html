{% extends "common/base.html" %}

{% block content %}
  {% now "Y-m-d" as today %}
  <div class="row">
    <div class="col-xs-3 text-left">
      {% if previous_week.week_number %}
        {% if user.is_authenticated %}
          <a href="/week/{{ previous_week.week_number }}" role="button" class="btn btn-default btn-lg">
            &laquo; <span class="hidden-xs">Week</span> {{ previous_week.week_number }}
          </a>
        {% else %}
          <a href="/site/{{ aimhigh_site.pk }}/week/{{ previous_week.week_number }}" role="button"
             class="btn btn-default btn-lg">
            &laquo; <span class="hidden-xs">Week</span> {{ previous_week.week_number }}
          </a>
        {% endif %}
      {% endif %}
    </div>
    <div class="col-xs-6 text-center">
      <h2 style="margin-top: 10px">Week {{ week.week_number }}</h2>
    </div>
    <div class="col-xs-3 text-right">
      {% if next_week %}
        {% if user.is_authenticated %}
          <a href="/week/{{ next_week.week_number }}" role="button" class="btn btn-default btn-lg">
            <span class="hidden-xs">Week</span> {{ next_week.week_number }} &raquo;
          </a>
        {% else %}
          <a href="/site/{{ aimhigh_site.pk }}/week/{{ next_week.week_number }}" role="button"
             class="btn btn-default btn-lg">
            <span class="hidden-xs">Week</span> {{ next_week.week_number }} &raquo;
          </a>
        {% endif %}
      {% endif %}
    </div>
  </div>
  <hr style="margin-top: 10px"/>
  {% if schedule %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead>
        <tr>
          <th></th>
          {% for calendar_day in calendar_days %}
            <th class="text-center {% if calendar_day.date.isoformat == today %}table-cell-today{% endif %}"
                style="min-width: 150px; width:250px;">
              {{ calendar_day|date:"D, M d" }}
            </th>
          {% endfor %}
        </tr>
        </thead>
        <tbody>
        {% for period in periods %}
          <tr>
            <th class="table-cell-period">
              {{ period.name }}
            </th>
            {% for calendar_day in calendar_days %}
              {% for work_day in schedule %}
                {% if work_day.date == calendar_day %}
                  {% for period_details in work_day.periods %}
                    {% if period_details.period == period %}
                      <td class="{% if calendar_day.isoformat == today %}table-cell-today{% endif %}">
                        <div class="table-cell">
                          {% block cell %}{% endblock %}
                        </div>
                      </td>
                    {% endif %}
                  {% endfor %}
                {% endif %}
              {% endfor %}
            {% endfor %}
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div> <!-- /.table-responsive -->
  {% else %}
    <p>Schedule is not available.</p>
  {% endif %}
{% endblock %}